<div id="page-wrapper">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">List of all appointments </h1>
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->


        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-default">


                    <div class="panel-body">
                        <div class="table-responsive">
                            <table id="doctors-appointments-list-table"class="table table-striped table-bordered table-hover" id="dataTables-example">
                                <thead>
                                    <tr>
                                        <th>Appointment Id</th>
                                        <th>Scheduled at</th>
                                        <th>Reserved at</th>
                                        <th>Office</th>
                                        <th>Patient' ID</th>


                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="odd gradeX">
                                        <td>Trident</td>
                                        <td>Trident</td>
                                        <td>Trident</td>
                                        <td>Trident</td>
                                        <td>Trident</td>

                                    </tr>

                                </tbody>
                            </table>
                        </div>


                    </div>
                    <!-- /.panel-body -->
                </div>
                <!-- /.panel -->
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->

    </div>
    <!-- /.container-fluid -->
</div>
<!-- /#page-wrapper -->

<script type="text/javascript">

   getAllAppointments();

  /* function getAllAppointments() {
    $.ajax({
         url: "http://localhost/doctorappointment/api/doctor/appointments",
         type: "GET",
         beforeSend: function(xhr){xhr.setRequestHeader('Authentication', localStorage.getItem("token"));},
         success: function(data) {
            console.log(data);
                var html ="";
                for(var i =0 ; i<data.length; i++) {
                  html +='<tr class="odd">'
                    +'<td>'+data[i].scheduled_at+'</td>'
                    +'<td>'+data[i].reserved_at+'</td>'
                    +'<td>'+data[i].office+'</td>';
                }
                  $("#doctors-appointments-list-table tbody").html(html);
             }
      });
  } */

  function getAllAppointments() {

    $("#doctors-appointments-list-table").DataTable({

      processing : true,
      serverSide : true,
      bDestory : true,
      pagingType : "simple",
      searching : false,
      ordering : false,
      preDrawCallback : function (settings) {
        if (settings.aoData.length < settings._iDisplayLength) {
          settings._iRecordsTotal=0;
          settings._iRecordsDisplay=0;
        } else {
        settings._iRecordsTotal=100000000;
        settings._iRecordsDisplay=10000000; }
        console.log(settings);
      },
      "language": {
        "lengthMenu": "Display _MENU_ records per page",
       "zeroRecords": "Nothing found - sorry",
       "info": "Showing page _PAGE_",
       "infoEmpty": "Showing page _PAGE_",
       "infoFiltered": ""
        },
      "ajax" : {
        url : "http://localhost/doctorappointment/api/doctor/appointments",
        type : "GET",
        beforeSend: function(xhr){xhr.setRequestHeader('Authentication', localStorage.getItem("token"));},
        dataSrc: function (resp) {
          console.log(resp);
          return resp;
        },
        data :  function (d) {
        /*  d.offset=d.start;
          d.limit=d.length;
          d.search=d.search.value;
          d.order = encodeURIComponent((d.order[0].dir == 'asc' ? "-" : "+")+d.columns[d.order[0].column].data); */

          delete d.start;
          delete d.length;
          delete d.column;
          delete d.draw;

        } },
        /*initComplete: function (settings){
          settings._iRecordsTotal=2;
          settings._iRecordsDisplay=2;
          settings.iDraw=2;
        }, */

      columns: [
          { "data" : "appointment_id",
            "render" : function (data,type,row,meta) {
            return '<span class="badge">'+data+'</span><a class="pull-right" style="font-size: 15px; cursor: pointer;"></a>';


            }

        },

        { "data" : "scheduled_at"},
        { "data" : "reserved_at"},
        { "data" : "office"},
        { "data" : "patient_id"}



      ],
    }).on('xhr.dt',function(e,settings,json,xhr) {
      console.log(settings);



    }); }


</script>
